import{ak as De,ap as _,r as p,j as a,a as e,b_ as Re,h as ke,E as ae,p as k,N as Pe,m as Ee,L as u,d as F,a3 as q,cx as xe,aU as Le,u as Y,P as W,F as U,I as _e,f as Oe,cy as Z,bN as Q,C as $,b as ee,aw as Ie,q as J,s as H,H as Fe,J as Ve,_ as we,cn as Ue,a7 as pe,a2 as oe,ab as $e,ac as fe,aP as He,ce as We,a9 as Be,w as Ge,an as Ye,bb as re,be as ze}from"./index-4a091edb.js";import{T as ye}from"./Textarea-17af0c3b.js";var je=function(s){return new Promise(function(l){setTimeout(l,s)})};const de=De(je),R={snapBackDuration:300,maxTilt:5,bouncePower:.1,swipeThreshold:100},Je=t=>{const s=window.getComputedStyle(t),l=s.getPropertyValue("width"),g=Number(l.split("px")[0]),P=s.getPropertyValue("height"),w=Number(P.split("px")[0]);return{x:g,y:w}},ve=(t,s)=>Math.sqrt(Math.pow(t,2)+Math.pow(s,2)),Ke=(t,s=1)=>{const l=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x*s/l,y:t.y*s/l}},ie=async(t,s,l=!1)=>{const g=te(t),P=Je(document.body),w=ve(P.x,P.y),o=ve(s.x,s.y),f=w/o,d=w/o,v=me(s.x*d+g.x,-s.y*d+g.y);let h="";const c=200;l?t.style.transition="ease "+f+"s":t.style.transition="ease-out "+f+"s",z(t)===0?h=j((Math.random()-.5)*c):z(t)>0?h=j(Math.random()*c/2+z(t)):h=j((Math.random()-1)*c/2+z(t)),t.style.transform=v+h,await de(f*1e3)},Ne=async t=>{t.style.transition=R.snapBackDuration+"ms";const s=te(t),l=me(s.x*-R.bouncePower,s.y*-R.bouncePower),g=j(z(t)*-R.bouncePower);t.style.transform=l+g,await de(R.snapBackDuration*.75),t.style.transform="none",await de(R.snapBackDuration),t.style.transition="10ms"},be=t=>{if(Math.abs(t.x)>Math.abs(t.y)){if(t.x>R.swipeThreshold)return"right";if(t.x<-R.swipeThreshold)return"left"}else{if(t.y>R.swipeThreshold)return"up";if(t.y<-R.swipeThreshold)return"down"}return"none"},Se=(t,s)=>{const l=s.x-t.x,g=t.y-s.y,P=(s.time-t.time)/1e3;return{x:l/P,y:g/P}},me=(t,s)=>"translate("+t+"px)",j=t=>"rotate("+t+"deg)",te=t=>{const s=window.getComputedStyle(t),l=new DOMMatrix(s.transform);return{x:l.m41,y:-l.m42}},z=t=>{const s=window.getComputedStyle(t),l=new DOMMatrix(s.transform);return-Math.asin(l.m21)/(2*Math.PI)*360},qe=(t,s,l,g)=>{const P={x:t.x+l.x,y:t.y+l.y},w={x:P.x,y:P.y,time:new Date().getTime()},o=me(P.x),f=Se(g,w).x/1e3,d=j(f*R.maxTilt);return s.style.transform=o+d,w},ce=t=>{const s=t.targetTouches[0];return{x:s.clientX,y:s.clientY}},le=t=>({x:t.clientX,y:t.clientY}),Xe=_.forwardRef(({flickOnSwipe:t=!0,children:s,onSwipe:l,onCardLeftScreen:g,className:P,preventSwipe:w=[],swipeRequirementType:o="velocity",swipeThreshold:f=R.swipeThreshold,onSwipeRequirementFulfilled:d,onSwipeRequirementUnfulfilled:v},h)=>{R.swipeThreshold=f;const c=_.useRef(!1),i=_.useRef();_.useImperativeHandle(h,()=>({async swipe(S="right"){l&&l(S);const y=1e3,n=(Math.random()-.5)*100;S==="right"?await ie(i.current,{x:y,y:n},!0):S==="left"&&await ie(i.current,{x:-y,y:n},!0),i.current.style.display="none",g&&g(S)},async restoreCard(){i.current.style.display="block",await Ne(i.current)}}));const r=_.useCallback(async(S,y)=>{if(c.current)return;c.current=!0;const n=te(S),m=be(o==="velocity"?y:n);if(m!=="none"&&(l&&l(m),t&&!w.includes(m))){const E=o==="velocity"?y:Ke(n,600);await ie(S,E),S.style.display="none",g&&g(m);return}Ne(S)},[c,t,l,g,w,o]),I=_.useCallback(()=>{c.current=!1},[c]);return _.useLayoutEffect(()=>{let S={x:null,y:null},y={x:0,y:0},n={x:0,y:0,time:new Date().getTime()},m=!1,E="none";i.current.addEventListener("touchstart",N=>{N.preventDefault(),I(),S={x:-ce(N).x,y:-ce(N).y}}),i.current.addEventListener("mousedown",N=>{N.preventDefault(),m=!0,I(),S={x:-le(N).x,y:-le(N).y}});const A=N=>{if(d||v){const T=be(o==="velocity"?y:te(i.current));T!==E&&(E=T,E==="none"?v&&v():d&&d(T))}const M=qe(N,i.current,S,n);y=Se(n,M),n=M};i.current.addEventListener("touchmove",N=>{N.preventDefault(),A(ce(N))}),i.current.addEventListener("mousemove",N=>{N.preventDefault(),m&&A(le(N))}),i.current.addEventListener("touchend",N=>{N.preventDefault(),r(i.current,y)}),i.current.addEventListener("mouseup",N=>{m&&(N.preventDefault(),m=!1,r(i.current,y))}),i.current.addEventListener("mouseleave",N=>{m&&(N.preventDefault(),m=!1,r(i.current,y))})},[]),_.createElement("div",{ref:i,className:P},s)});function he(){const{View:t}=p.useContext(B),[s,l]=t;return a("div",{className:"home-header",children:[e(Re,{onClick:()=>l("profile")}),e("img",{className:"logo",src:"./assets/img/icons/tinder/logo.svg",onClick:()=>l("home")}),e(ke,{onClick:()=>l("messageList")})]})}const V={account:{name:"James",bio:"I'm a cool guy",dob:9624888e5,photos:["https://r2.fivemanage.com/images/GRBUI6C4orbD.webp","https://r2.fivemanage.com/images/98avzSwlgzsg.webp","https://r2.fivemanage.com/images/rafgjPwSYnn2.png"],showMen:!1,showWomen:!0,isMale:!0,active:!0},accounts:[{number:"1",dob:9653888e5,name:"Jessica",bio:"Swipe right if you like dogs",photos:["https://r2.fivemanage.com/images/oRKcdeTA8oBy.png"],isMale:!1,matched:!0},{number:"2",dob:9653888e5,name:"Klara",bio:"Member of Lost MC, looking for a good time",photos:["https://r2.fivemanage.com/images/787FMzhn5xD5.png","https://r2.fivemanage.com/images/ZsmnyJOA2rc5.png"],isMale:!1,liked:!0},{number:"3",dob:9653888e5,name:"Steph",bio:"Evening strolls are my thing",photos:["https://r2.fivemanage.com/images/7zj3Xgy6FsXK.png"],matched:!0,isMale:!1,lastMessage:"I'm perfect, you look good!"}],messages:{3:[{sender:"1",content:"Im perfect, you look good!",timestamp:Date.now()-1e3*60*60*24*1},{sender:"1234567890",content:"I'm good, how about you?",timestamp:Date.now()-1e3*60*60*24*2},{sender:"1",content:"Hey, how are you?",timestamp:Date.now()-1e3*60*60*24*3}]}};function Ze(){const{View:t,User:s,Account:l}=p.useContext(B),[g,P]=t,[w,o]=s,[f,d]=l,[v,h]=p.useState([]),[c,i]=p.useState(0),[r,I]=p.useState(),S=p.useRef(c),y=p.useRef(0),[n,m]=p.useState([]),[E,A]=p.useState(0),[N,M]=p.useState(!1),[T,x]=p.useState(null);let[G,D]=p.useState("");p.useEffect(()=>{ae("Tinder")&&k("Tinder",{action:"getFeed",page:0},V.accounts.filter(b=>!b.matched)).then(b=>{b&&b.length>0?(h(b),i(b.length-1),y.current=b.length,m(Array(b.length).fill(0).map(C=>_.createRef()))):M(!0)})},[]);const O=b=>{i(b),S.current=b},ne=c<v.length-1,Te=c>=0,Me=(b,C,L)=>{I(b),O(L-1),ge(),b==="right"?k("Tinder",{action:"swipe",like:!0,number:C.number},V.accounts.find(X=>X.liked&&X.number==C.number)).then(X=>{X&&x(C)}):b==="left"&&k("Tinder",{action:"swipe",like:!1,number:C.number})},Ae=(b,C)=>{S.current>=C&&n[C].current.restoreCard()},ue=async b=>{Te&&c<v.length&&(await n[c].current.swipe(b),ge())},Ce=async()=>{var C,L;if(!ne)return;const b=c+1;O(b),await((L=(C=n[b])==null?void 0:C.current)==null?void 0:L.restoreCard())},ge=()=>{if(y.current>1){y.current=y.current-1;return}k("Tinder",{action:"getFeed",page:E+1}).then(b=>{if(b)if(b&&b.length>0){A(E+1);let C=b.length+v.length;h(L=>(L=[...L,...b],L)),y.current=b.length,i(C-1),m(Array(C).fill(0).map(L=>_.createRef()))}else M(!0)})};return a("div",{className:`home-wrapper slide ${g=="profile"?"left":"right"}`,children:[e(he,{}),e(Pe,{children:T&&a(Ee.div,{initial:{opacity:0,scale:.1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.1},transition:{duration:.3,ease:"easeInOut"},className:"match",style:{backgroundImage:`url(${T.photos[0]})`},children:[e("img",{className:"match-image",src:"./assets/img/icons/tinder/match.png"}),a("div",{className:"likes-too",children:[T.name," ",u("APPS.TINDER.LIKES_YOU_TOO").toLowerCase()]}),a("div",{className:"input",children:[e(F,{type:"text",placeholder:u("APPS.TINDER.SAY_SOMETHING_NICE"),onChange:b=>D(b.target.value)}),e("div",{className:"send",onClick:()=>{k("Tinder",{action:"sendMessage",data:{recipient:T.number,content:G}},!0).then(b=>{b&&(o(T),P("message"))})},children:u("APPS.TINDER.SEND")})]}),e("div",{className:"keep-swiping",onClick:()=>x(null),children:u("APPS.TINDER.KEEP_SWIPING")})]})}),a("div",{className:"home-body",children:[a("div",{className:"cards",children:[N&&e("div",{className:"card no-more",children:e("div",{children:u("APPS.TINDER.NO_MORE")})}),!f.active&&e("div",{className:"card no-more",children:e("div",{children:u("APPS.TINDER.HIDDEN_PROFILE")})}),f.active&&v.map((b,C)=>e(Xe,{ref:n[C],className:"swipe",onSwipe:L=>Me(L,b,C),onCardLeftScreen:()=>Ae(b,C),children:e(Qe,{user:b})},C))]}),a("div",{className:"actions",children:[e("div",{className:"button",onClick:()=>ue("left"),children:e(q,{style:{color:"#F24C65"}})}),e("div",{className:`button small ${ne?"":"disabled"}`,onClick:()=>Ce(),children:e(xe,{style:{rotate:"180deg",color:"#F2B721"}})}),e("div",{className:"button",onClick:()=>ue("right"),children:e(Le,{style:{color:"#3CDBA7"}})})]})]})]})}const Qe=t=>{let s=t.user;const[l,g]=p.useState(0),[P,w]=p.useState(0);return p.useEffect(()=>{w(K(s.dob))},[s]),a("div",{className:"card",style:{backgroundImage:`url(${s.photos[l]})`},onClick:o=>{l<s.photos.length-1?g(l+1):g(0)},children:[s.photos.length>1&&e("div",{className:"image-count",children:s.photos.map((o,f)=>e("div",{className:`image ${f==l?"active":""}`,onClick:d=>{d.stopPropagation(),g(f)}}))}),a("div",{className:"card-content",children:[a("div",{className:"name",children:[s.name," ",e("span",{children:P})]}),e("div",{className:"description",children:s.bio})]})]})};function et(){const{LoggedIn:t,Account:s}=p.useContext(B),l=Y(W.PhoneNumber),[g,P]=s,[w,o]=t,[f,d]=p.useState("notLoggedIn"),[v,h]=p.useState(0),[c,i]=p.useState({});p.useEffect(()=>{ae("Tinder")&&(f=="notLoggedIn"?W.Styles.TextColor.set("#ffffff"):W.Styles.TextColor.set("#000000"))},[f]);const[r,I]=p.useState({name:null,photos:[],_dob:{day:"",month:"",year:""},dob:null,bio:null,showMen:!1,showWomen:!1,isMale:null,active:!0}),S=m=>{var E,A,N;switch(m){case 0:let M=new Date(`${(E=r._dob)==null?void 0:E.year}/${(A=r._dob)==null?void 0:A.month}/${(N=r._dob)==null?void 0:N.day}`);if(y(M)){let T=K(M);r.name&&r.name.length>=2&&T>=18&&T<=100&&(I({...r,dob:M.getTime()}),h(m+1))}break;case 1:r.photos.length>0&&h(m+1);break;case 2:r.bio&&r.bio.length>=10&&h(m+1);break;case 3:(r.showMen||r.showWomen)&&h(m+1);break;case 4:(r.isMale==!0||r.isMale==!1)&&k("Tinder",{action:"createAccount",data:{...r,dob:new Date(r.dob).toISOString().split("T")[0]}},!0).then(T=>{if(!T)return J("error","Failed to create account");H.APPS.TINDER.account.set(r),P(r),o(!0)});break}},y=m=>m.getTime()===m.getTime();let n=[u("APPS.TINDER.CREATE_ACCOUNT"),u("APPS.TINDER.ADD_PHOTOS"),u("APPS.TINDER.DESCRIPTION"),u("APPS.TINDER.SHOW_ME"),u("APPS.TINDER.I_AM")];return e("div",{className:"login-container",style:{background:f==="notLoggedIn"?"linear-gradient(45deg, #ff4573, #ff5f65)":"#ffffff"},children:f==="notLoggedIn"?a(U,{children:[a("div",{className:"logo",children:[e("img",{src:"./assets/img/icons/tinder/logo-white.svg"}),e("div",{className:"logo-text",children:u("APPS.TINDER.TITLE").toLowerCase()})]}),a("div",{className:"buttons",children:[e("div",{className:"disclamer",children:u("APPS.TINDER.AGREE_TERMS")}),e("div",{className:"button create",onClick:()=>d("createAccount"),children:u("APPS.TINDER.CREATE_ACCOUNT")})]})]}):a("div",{className:"create-account",children:[a("div",{className:"login-header",children:[e(_e,{onClick:()=>{v>0?h(v-1):d("notLoggedIn")}}),e("div",{className:"title",children:n[v]})]}),v==0&&e(U,{children:a("div",{className:"form-body",children:[e(F,{defaultValue:Oe(l),type:"text",disabled:!0}),e(F,{placeholder:"Name",type:"text",maxLength:25,onChange:m=>{I({...r,name:m.target.value}),m.target.value.length>=3?i({...c,name:!0}):i({...c,name:!1})}}),a("div",{className:"dob",children:[a("div",{className:"inputs",children:[e(F,{placeholder:"MM",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:m=>{I({...r,_dob:{...r._dob,month:m.target.value}})}}),e("span",{children:"/"}),e(F,{placeholder:"DD",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:2,maxLength:2,onChange:m=>{I({...r,_dob:{...r._dob,day:m.target.value}})}}),e("span",{children:"/"}),e(F,{placeholder:"YYYY",type:"text",pattern:"/^-?\\d+\\.?\\d*$/",minLength:4,maxLength:4,onChange:m=>{var M,T,x;let E={...r,_dob:{...r._dob,year:m.target.value}};I(E);let A=new Date(`${(M=E._dob)==null?void 0:M.year}/${(T=E._dob)==null?void 0:T.month}/${(x=E._dob)==null?void 0:x.day}`),N=K(A);N>=18&&N<100?i({...c,18:!0}):i({...c,18:!1})}})]}),e("div",{className:"disclamer",children:u("APPS.TINDER.AGE_PUBLIC")}),a("div",{className:"requirement",children:[c[18]?e(Z,{className:"green"}):e(Q,{className:"red"}),u("APPS.TINDER.BE_OVER_18")]}),a("div",{className:"requirement",children:[c.name?e(Z,{className:"green"}):e(Q,{className:"red"}),u("APPS.TINDER.NAME_MINIMUM")]})]})]})}),v==1&&a(U,{children:[e("div",{className:"photo-grid",children:[...Array(6)].map((m,E)=>{var N;let A=((N=r.photos)==null?void 0:N[E-1])||E==0;return r.photos[E]?e("div",{className:"photo",style:{backgroundImage:`url(${r.photos[E]})`},children:e("div",{className:"button remove",onClick:()=>{let M=r.photos;M.splice(E,1),I({...r,photos:M}),M.length==0&&i({...c,photos:!1})},children:e(q,{})})}):e("div",{className:"photo",children:A&&e("div",{className:"button add",onClick:()=>{var M,T,x;$.Gallery.set({allowExternal:(x=(T=(M=ee)==null?void 0:M.value)==null?void 0:T.AllowExternal)==null?void 0:x.Spark,onSelect:G=>I({...r,photos:[...r.photos,G.src]})}),i({...c,photos:!0})},children:e(Ie,{})})})})}),a("div",{className:"requirement",children:[c.photos?e(Z,{className:"green"}):e(Q,{className:"red"}),u("APPS.TINDER.PHOTOS_MINIMUM")]})]}),v==2&&a(U,{children:[e(ye,{placeholder:"Description",maxLength:200,onChange:m=>{I({...r,bio:m.target.value}),m.target.value.length>=10?i({...c,bio:!0}):i({...c,bio:!1})}}),a("div",{className:"requirement",children:[c.bio?e(Z,{className:"green"}):e(Q,{className:"red"}),u("APPS.TINDER.DESCRIPTION_MINIMUM")]})]}),v==3&&e(U,{children:a("div",{className:"showme",children:[e("div",{className:`button border ${r.showWomen&&!r.showMen?"active":""}`,onClick:()=>{I({...r,showMen:!1,showWomen:!0})},children:u("APPS.TINDER.WOMEN")}),e("div",{className:`button border ${r.showMen&&!r.showWomen?"active":""}`,onClick:()=>{I({...r,showMen:!0,showWomen:!1})},children:u("APPS.TINDER.MEN")}),e("div",{className:`button border ${r.showMen&&r.showWomen?"active":""}`,onClick:()=>{I({...r,showMen:!0,showWomen:!0})},children:u("APPS.TINDER.EVERYONE")})]})}),v==4&&e(U,{children:a("div",{className:"showme",children:[e("div",{className:`button border ${r.isMale===!0?"active":""}`,onClick:()=>{I({...r,isMale:!0})},children:u("APPS.TINDER.MALE")}),e("div",{className:`button border ${r.isMale===!1?"active":""}`,onClick:()=>{I({...r,isMale:!1})},children:u("APPS.TINDER.FEMALE")})]})}),e("div",{className:"button gradient",onClick:()=>S(v),children:u("APPS.TINDER.CONTINUE")})]})})}const se=Fe(null);function tt(){var y;const{View:t,User:s}=p.useContext(B);Y(W.Settings);const l=Y(W.PhoneNumber),[g,P]=s,[w,o]=t,f=Y(se),[d,v]=p.useState([]),h=p.useRef(null),c=p.useRef(0),[i,r]=p.useState({content:"",attachments:[]});p.useEffect(()=>{ae("Tinder")&&k("Tinder",{action:"getMessages",page:0,number:g.number},V.messages[g.number]).then(n=>{n&&n.length>0?v(n.reverse()):setFetchedEverything(!0)})},[]);const I=()=>{if(i.content.length===0&&i.attachments.length===0)return;const n={sender:l,recipient:g.number,content:i.content,attachments:i.attachments,timestamp:new Date().getTime()};k("Tinder",{action:"sendMessage",data:n},!0).then(m=>{if(!m)return J("error","Failed to send message");h.current.value="",r({content:"",attachments:[]}),v([...d,n])})},{handleScroll:S}=Ve({fetchData:n=>k("Tinder",{action:"getMessages",number:g.number,page:n}),onDataFetched:n=>()=>{let m=document.querySelector(".message-container");c.current=m.scrollHeight,v([...n.reverse(),...d])},perPage:25});return p.useEffect(()=>{let n=document.querySelector(".message-container");const m=n.scrollHeight;n.scrollTop+=m-c.current,n.scroll},[d]),we("tinder:newMessage",n=>{g.number===n.sender&&v([...d,n])}),a("div",{className:"home-wrapper slide left",children:[e(Pe,{children:f&&e(st,{})}),a("div",{className:"message-header",children:[e(Ue,{onClick:()=>{o("messageList"),P(null)}}),a("div",{className:"user",onClick:()=>se.set(g),children:[e("img",{className:"profile-picture",src:(y=g.photos)==null?void 0:y[0]}),e("div",{className:"name",children:g.name})]})]}),e("div",{className:"message-container",onScroll:S,children:e("div",{className:"message-body",children:d.map((n,m)=>{var M,T,x,G;let E,A=n.sender===l?"self":"other",N=((M=d[m+1])==null?void 0:M.sender)===l?"self":"other";return d[m+1]?E=Math.abs(n.timestamp-d[m+1].timestamp)/36e5:N=void 0,a("div",{className:`message ${A}`,children:[A=="other"?a("div",{className:"message-with-pfp",children:[e("div",{className:`profile-picture ${A!==N?"show":"hide"}`,children:e("img",{src:(T=g.photos)==null?void 0:T[0]})}),a("div",{className:"message-content",children:[n.content&&e("div",{className:"content",children:pe(n.content)}),((x=n.attachments)==null?void 0:x.length)>0&&e("div",{className:"attatchments",children:n.attachments.map((D,O)=>oe(D)?e("video",{src:D,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:ne=>{$.FullscreenImage.set(D)}},O):e($e,{src:D,onClick:()=>{$.FullscreenImage.set(D)}},O))})]})]}):a(U,{children:[n.content&&e("div",{className:"content",children:pe(n.content)}),((G=n.attachments)==null?void 0:G.length)>0&&e("div",{className:"attatchments",children:n.attachments.map((D,O)=>oe(D)?e("video",{src:D,controls:!1,loop:!0,autoPlay:!0,muted:!0,onClick:()=>{$.FullscreenImage.set(D)}},O):e("img",{src:D,onClick:()=>{$.FullscreenImage.set(D)}},O))})]}),d[m+1]&&E>6?e("div",{className:"date",children:fe(n.timestamp)}):A!==N&&e("div",{className:"date",children:fe(n.timestamp)})]},m)})})}),e("div",{className:"attachments",children:i.attachments.map((n,m)=>a("div",{className:"attachment",children:[oe(n)?e("video",{src:n,controls:!1,muted:!0,loop:!0,autoPlay:!0}):e("img",{src:n}),e(q,{onClick:()=>{r({...i,attachments:i.attachments.filter((E,A)=>A!==m)})}})]}))}),a("div",{className:"message-bottom",children:[e(He,{className:"image",onClick:()=>{var n,m,E;i.attachments.length<3&&$.Gallery.set({includeVideos:!0,allowExternal:(E=(m=(n=ee)==null?void 0:n.value)==null?void 0:m.AllowExternal)==null?void 0:E.Messages,onSelect:A=>r({...i,attachments:[...i.attachments,A.src]})})}}),a("div",{className:"input",children:[e(F,{type:"text",placeholder:"Type a message...",ref:h,onChange:n=>{r({...i,content:n.target.value})},onKeyDown:n=>{n.key==="Enter"&&I()}}),e(We,{className:i.attachments.length>0||i.content.length>0?"active":"",onClick:()=>I()})]})]})]})}const st=()=>{const t=Y(se),[s,l]=p.useState(0);return t?a(Ee.div,{initial:{opacity:0,y:500},animate:{opacity:1,y:0},exit:{opacity:0,y:500},className:"popup-profile-container",children:[a("div",{className:"gallery",children:[e("img",{src:t==null?void 0:t.photos[s],onClick:()=>{t&&l(s<(t==null?void 0:t.photos.length)-1?s+1:0)}}),(t==null?void 0:t.photos.length)>1&&e("div",{className:"image-count",children:t==null?void 0:t.photos.map((g,P)=>e("div",{className:Be("image",P==s&&"active"),onClick:w=>{w.stopPropagation(),l(P)}}))}),e("div",{className:"close",onClick:()=>se.set(null),children:e(q,{})})]}),a("div",{className:"card-content",children:[a("div",{className:"name",children:[t==null?void 0:t.name,", ",e("span",{children:K(t==null?void 0:t.dob)})]}),e("div",{className:"divider"}),a("div",{className:"description",children:[e("div",{className:"title",children:"About Me"}),t==null?void 0:t.bio]})]})]}):null};function at(){const{View:t,User:s}=p.useContext(B),[l,g]=s,[P,w]=t,[o,f]=p.useState({newMatches:[],messages:[]});return p.useEffect(()=>{ae("Tinder")&&(W.Styles.TextColor.set("#000000"),k("Tinder",{action:"getMatches"},{newMatches:V.accounts.filter(d=>d.matched&&!V.messages[d.number]),messages:V.accounts.filter(d=>V.messages[d.number])}).then(d=>{if(!d)return J("warning","No response received from Tinder getMatches");f(d)}))},[]),we("tinder:newMessage",d=>{let v=d.sender,h=JSON.parse(JSON.stringify(o)),c=h.messages.findIndex(i=>i.number===v);if(c!==-1)h.messages.unshift(h.messages.splice(c,1)[0]);else if(c=h.newMatches.findIndex(i=>i.number===v),c!==-1)h.messages.unshift(h.newMatches.splice(c,1)[0]);else return;h.messages[0].lastMessage=d.content,f(h)}),a("div",{className:"home-wrapper slide left",children:[e(he,{}),e(Ge,{placeholder:u("APPS.TINDER.SEARCH_MATCHES"),onChange:()=>{}})," ",a("div",{className:"message-list-body",children:[a("div",{className:"new-matches",children:[a("div",{className:"title",children:[u("APPS.TINDER.NEW_MATCHES"),o.newMatches.length>0&&e("span",{children:o.newMatches.length})]}),e("div",{className:"matches",children:o.newMatches.map((d,v)=>{var h;return a("div",{className:"new-match",onClick:()=>{g(d),w("message")},children:[e("img",{className:"profile-picture",src:(h=d.photos)==null?void 0:h[0]}),e("div",{className:"name",children:d.name})]},v)})})]}),a("div",{className:"recent-messages",children:[e("div",{className:"title",children:u("APPS.TINDER.MESSAGES")}),e("div",{className:"messages",children:o.messages.map((d,v)=>{var h,c;return((h=d.lastMessage)==null?void 0:h.length)===0&&(d.lastMessage=u("APPS.MESSAGES.SENT_A_PHOTO")),a("div",{className:"message",onClick:()=>{g(d),w("message")},children:[e("img",{className:"profile-picture",src:(c=d.photos)==null?void 0:c[0]}),a("div",{className:"user",children:[e("div",{className:"name",children:d.name}),e("div",{className:"message",children:d.lastMessage.length>40?d.lastMessage.substring(0,40)+"...":d.lastMessage})]})]},v)})})]})]})]})}function nt(){var d,v;const{Account:t,LoggedIn:s}=p.useContext(B),[l,g]=s,[P,w]=t,[o,f]=p.useState(P);return a("div",{className:"home-wrapper slide right",style:{backgroundColor:"#F6F6F6"},children:[e(he,{}),a("div",{className:"profile-body",children:[a("div",{className:"user",children:[e("img",{className:"profile-picture",src:o.photos[0]}),a("div",{className:"name",children:[o.name,", ",K(o.dob)]})]}),a("div",{className:"inputs",children:[a("div",{className:"input",children:[e("div",{className:"label",children:u("APPS.TINDER.NAME")}),e(F,{type:"text",defaultValue:o.name,maxLength:10,onChange:h=>{f({...o,name:h.target.value})}})]}),a("div",{className:"input center",children:[e("div",{className:"label",children:u("APPS.TINDER.PHOTOS")}),e("div",{className:"photo-grid",children:[...Array(6)].map((h,c)=>{var r;let i=((r=o.photos)==null?void 0:r[c-1])||c==0;return o.photos[c]?e("div",{className:"photo",style:{backgroundImage:`url(${o.photos[c]})`},children:e("div",{className:"photo-button remove",onClick:()=>{let I=o.photos;I.splice(c,1),f({...o,photos:I})},children:e(q,{})})},c):e("div",{className:"photo",children:i&&e("div",{className:"photo-button add",onClick:()=>{var I,S,y;$.Gallery.set({allowExternal:(y=(S=(I=ee)==null?void 0:I.value)==null?void 0:S.AllowExternal)==null?void 0:y.Spark,onSelect:n=>f({...o,photos:[...o.photos,n.src]})})},children:e(Ie,{})})})})})]}),a("div",{className:"input",children:[e("div",{className:"label",children:u("APPS.TINDER.ABOUT_ME")}),e(ye,{type:"text",defaultValue:o.bio,maxLength:100,onChange:h=>{f({...o,bio:h.target.value})}})]}),a("div",{className:"input",children:[e("div",{className:"label",children:u("APPS.TINDER.INTERESTED_IN")}),a("select",{value:o.showMen&&o.showWomen?"Everyone":o.showMen?"Men":"Women",onChange:h=>{switch(h.target.value){case"Everyone":f({...o,showMen:!0,showWomen:!0});break;case"Men":f({...o,showMen:!0,showWomen:!1});break;case"Women":f({...o,showMen:!1,showWomen:!0});break}},children:[e("option",{value:"Men",children:u("APPS.TINDER.MEN")}),e("option",{value:"Women",children:u("APPS.TINDER.WOMEN")}),e("option",{value:"Everyone",children:u("APPS.TINDER.EVERYONE")})]})]}),a("div",{className:"input",children:[e("div",{className:"label",children:u("APPS.TINDER.GENDER")}),a("select",{value:o.isMale?"male":"female",onChange:h=>{h.target.value=="male"?f({...o,isMale:!0}):f({...o,isMale:!1})},children:[e("option",{value:"male",children:u("APPS.TINDER.MALE")}),e("option",{value:"female",children:u("APPS.TINDER.FEMALE")})]})]}),a("div",{className:"input",children:[e("div",{className:"label",children:u("APPS.TINDER.VISIBILITY")}),a("select",{value:o.active?"visible":"hidden",onChange:h=>{let c=h.target.value;f({...o,active:c==="visible"})},children:[e("option",{value:"visible",children:u("APPS.TINDER.VISIBLE")}),e("option",{value:"hidden",children:u("APPS.TINDER.HIDDEN")})]}),!o.active&&e("div",{className:"warning",children:u("APPS.TINDER.HIDDEN_WARNING")})]})]}),((v=(d=ee)==null?void 0:d.value)==null?void 0:v.DeleteAccount.Spark)&&e("div",{className:"button red",onClick:()=>{Ye("Tinder",()=>{w(null),g(!1)},!0)},children:u("APPS.TINDER.DELETE_ACCOUNT")}),e("div",{className:"button gradient",onClick:()=>{o.name.length>=2&&o.bio.length>=5&&o.photos.length>=1?k("Tinder",{action:"saveProfile",data:o},!0).then(h=>{if(!h)return J("error","Issue saving tinder profile");H.APPS.TINDER.account.set(o),w(o)}):J("error","Issue saving tinder profile, (name not 2 characters, bio not over 5 or no photos)")},children:u("APPS.TINDER.SAVE")})]})]})}const B=p.createContext(null);function it(){const t=Y(W.Settings),[s,l]=p.useState(!1),[g,P]=p.useState(null),[w,o]=p.useState(null),[f,d]=p.useState("home"),[v,h]=p.useState(!0),c={home:e(Ze,{}),profile:e(nt,{}),messageList:e(at,{}),message:e(tt,{})};return p.useEffect(()=>{if(H.APPS.TINDER.account.value){P(H.APPS.TINDER.account.value),l(!0),h(!1);return}else if(H.APPS.TINDER.account.value===!1)return h(!1);k("Tinder",{action:"isLoggedIn"},V.account).then(i=>{i?(P(i),l(!0),H.APPS.TINDER.account.set(i)):H.APPS.TINDER.account.set(!1),h(!1)})},[]),p.useEffect(()=>(f==="message"?re.ReceiveAppNotifications.set(!1):re.ReceiveAppNotifications.set(!0),()=>{re.ReceiveAppNotifications.set(!0)}),[f]),e("div",{className:"tinder-container",children:e(B.Provider,{value:{LoggedIn:[s,l],Account:[g,P],User:[w,o],View:[f,d]},children:v||t!=null&&t.airplaneMode?e("div",{className:"loading",children:e(ze,{size:40,lineWeight:5,speed:2,color:"#000000"})}):s?c[f]:e(et,{})})})}function K(t){var s=+new Date(t);return~~((Date.now()-s)/315576e5)}export{B as TinderContext,it as default,K as getAge};
